# üöÄ DotLink API

DotLink is a social network backend service built with **ASP.NET Core** following the **Clean Architecture (CQRS)** pattern, utilizing **MediatR** for robust command and query handling.

---

## üåü Key Features

* **Clean Architecture (CQRS):** Clear separation of concerns with distinct layers and dedicated MediatR handlers for Commands (write) and Queries (read).
* **PostgreSQL & Entity Framework Core:** Reliable data persistence layer.
* **JWT Authentication:** Secure token-based authentication for all protected endpoints.
* **FluentValidation:** Comprehensive validation pipeline integrated into the MediatR behaviors for enforcing business rules.
* **Local File Storage:** Infrastructure for storing user profile pictures, easily swappable with cloud storage providers (e.g., AWS S3 or Azure Blob Storage).

---

## üõ†Ô∏è Technologies & Dependencies

| Category | Technology | Purpose |
| :--- | :--- | :--- |
| **Framework** | ASP.NET Core 8+ | Primary API framework. |
| **Database** | PostgreSQL | Robust relational database. |
| **ORM** | Entity Framework Core | Database interaction and migrations. |
| **Pattern** | MediatR (CQRS) | Implementing Command and Query separation. |
| **Validation** | FluentValidation | Input and business logic validation. |
| **Security** | JWT Bearer | Token authentication scheme. |
| **Documentation** | Swashbuckle (Swagger) | Interactive API documentation. |

---

## üèóÔ∏è Project Structure (Clean Architecture)

The solution is organized into logical layers, ensuring minimal dependencies flowing inward:

* **`DotLink.Api` (Presentation):** Contains controllers, dependency injection configuration, middleware, and Swagger setup. Maps HTTP requests to Commands and Queries.
* **`DotLink.Application` (Application Core):** Defines all **Commands**, **Queries**, their corresponding **Handlers**, repository interfaces, and **FluentValidation** rules.
* **`DotLink.Domain` (Domain Core):** Contains the core business entities (`User`, `Post`, `Comment`) and business rules.
* **`DotLink.Infrastructure` (Infrastructure):** Provides concrete implementations for repository interfaces (using EF Core) and external services (`LocalFileStorageService`, `JwtService`).

---

## ‚öôÔ∏è Setup and Running Locally

### 1. Prerequisites

* [.NET SDK 8.0+](https://dotnet.microsoft.com/download)
* PostgreSQL server instance.

### 2. Configuration

1.  **Database Connection:** Update the `"DefaultConnection"` in `appsettings.json` and `appsettings.Development.json` for your PostgreSQL instance.
2.  **JWT Settings:** Configure the `"Jwt"` section with a strong secret key, issuer, and audience.
3.  **Storage Path:** Ensure the `StorageSettings:LocalStoragePath` is set (e.g., `"uploads"`).

### 3. Database Initialization

Navigate to the directory containing the solution file and apply migrations:

```bash
dotnet ef database update --project DotLink.Infrastructure
```

# 4. Running the Application üöÄ

Navigate to the API project directory (**DotLink.Api**) and run:

```bash
dotnet watch run
```

The application will be available at the address shown in the console (e.g., **http://localhost:5024**).

---

## üìö API Documentation (Swagger)

The interactive API documentation is automatically generated by Swashbuckle and can be accessed at:

üëâ **http://localhost:5024/swagger**

> **Note:** The Swagger UI is configured to **persist your authentication token in Local Storage**, so the token will not be lost when the server restarts.

---

## üñºÔ∏è File Handling

* **Upload:** Use the `POST /api/user/picture` endpoint with **multipart/form-data**.
* **Retrieve:** Files are served publicly via the `FileController`. To retrieve a profile picture, use the key returned after upload: `GET /api/file/{fileKey}` (e.g., `/api/file/profile-pics/guid.png`).

---

## ü§ù Contributing

If you wish to contribute or notice any bugs, please feel free to **open an Issue** or **submit a Pull Request**.
